{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Amoolya Suneja\\\\Desktop\\\\AI-Liveboard\\\\client\\\\src\\\\components\\\\whiteboard.jsx\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect, useContext } from 'react';\nimport { Stage, Layer, Line, Circle, Rect } from 'react-konva';\nimport { SHAPES, EVENTS } from '../utils/constants';\nimport useDrawing from '../hooks/useDrawing.js';\nimport { SocketContext } from '../context/SocketContext';\nimport { recognizeShape } from '../utils/shapeRecognition';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Whiteboard = ({\n  roomId,\n  users\n}) => {\n  _s();\n  const socket = useContext(SocketContext);\n  const stageRef = useRef(null);\n  const {\n    elements,\n    setElements,\n    isDrawing,\n    handleDrawStart,\n    handleDrawMove,\n    handleDrawEnd\n  } = useDrawing(socket, roomId);\n\n  // Socket listeners\n  useEffect(() => {\n    const handleRemoteDrawStart = element => {\n      setElements(prev => [...prev, element]);\n    };\n    const handleRemoteDrawMove = point => {\n      setElements(prev => {\n        const lastIndex = prev.length - 1;\n        const updated = [...prev];\n        updated[lastIndex] = {\n          ...updated[lastIndex],\n          points: [...updated[lastIndex].points, point]\n        };\n        return updated;\n      });\n    };\n    const handleShapeRecognized = shape => {\n      setElements(prev => [...prev.filter(el => !el.temp), {\n        ...shape,\n        id: Date.now()\n      }]);\n    };\n    socket.on(EVENTS.DRAW_START, handleRemoteDrawStart);\n    socket.on(EVENTS.DRAW_MOVE, handleRemoteDrawMove);\n    socket.on(EVENTS.SHAPE_RECOGNIZED, handleShapeRecognized);\n    return () => {\n      socket.off(EVENTS.DRAW_START, handleRemoteDrawStart);\n      socket.off(EVENTS.DRAW_MOVE, handleRemoteDrawMove);\n      socket.off(EVENTS.SHAPE_RECOGNIZED, handleShapeRecognized);\n    };\n  }, [setElements, socket]);\n\n  // Drawing events\n  const handleMouseDown = e => {\n    const pos = e.target.getStage().getPointerPosition();\n    handleDrawStart(pos.x, pos.y);\n  };\n  const handleMouseMove = e => {\n    if (!isDrawing) return;\n    const pos = e.target.getStage().getPointerPosition();\n    handleDrawMove(pos.x, pos.y);\n  };\n  const handleMouseUp = () => {\n    if (!isDrawing) return;\n    handleDrawEnd();\n    const lastElement = elements[elements.length - 1];\n    if ((lastElement === null || lastElement === void 0 ? void 0 : lastElement.type) === SHAPES.FREEHAND) {\n      const recognized = recognizeShape(lastElement.points);\n      if (recognized) {\n        socket.emit(EVENTS.SHAPE_RECOGNIZED, {\n          roomId,\n          shape: recognized\n        });\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"whiteboard\",\n    children: /*#__PURE__*/_jsxDEV(Stage, {\n      width: window.innerWidth - 300,\n      height: window.innerHeight - 100,\n      onMouseDown: handleMouseDown,\n      onMouseMove: handleMouseMove,\n      onMouseUp: handleMouseUp,\n      ref: stageRef,\n      children: /*#__PURE__*/_jsxDEV(Layer, {\n        children: elements.map(element => {\n          if (element.type === SHAPES.FREEHAND) {\n            return /*#__PURE__*/_jsxDEV(Line, {\n              points: element.points.flat(),\n              stroke: \"#000\",\n              strokeWidth: 5,\n              tension: 0.5,\n              lineCap: \"round\",\n              lineJoin: \"round\"\n            }, element.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 98,\n              columnNumber: 17\n            }, this);\n          }\n          if (element.type === SHAPES.CIRCLE) {\n            return /*#__PURE__*/_jsxDEV(Circle, {\n              x: element.x + element.radius,\n              y: element.y + element.radius,\n              radius: element.radius,\n              stroke: \"#000\",\n              strokeWidth: 3\n            }, element.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 111,\n              columnNumber: 17\n            }, this);\n          }\n          if (element.type === SHAPES.RECTANGLE) {\n            return /*#__PURE__*/_jsxDEV(Rect, {\n              x: element.x,\n              y: element.y,\n              width: element.width,\n              height: element.height,\n              stroke: \"#000\",\n              strokeWidth: 3\n            }, element.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 123,\n              columnNumber: 17\n            }, this);\n          }\n          return null;\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 5\n  }, this);\n};\n_s(Whiteboard, \"Snba7QfN+WOHf7wvPtlC3vp/bmU=\", false, function () {\n  return [useDrawing];\n});\n_c = Whiteboard;\nexport default Whiteboard;\nvar _c;\n$RefreshReg$(_c, \"Whiteboard\");","map":{"version":3,"names":["React","useRef","useEffect","useContext","Stage","Layer","Line","Circle","Rect","SHAPES","EVENTS","useDrawing","SocketContext","recognizeShape","jsxDEV","_jsxDEV","Whiteboard","roomId","users","_s","socket","stageRef","elements","setElements","isDrawing","handleDrawStart","handleDrawMove","handleDrawEnd","handleRemoteDrawStart","element","prev","handleRemoteDrawMove","point","lastIndex","length","updated","points","handleShapeRecognized","shape","filter","el","temp","id","Date","now","on","DRAW_START","DRAW_MOVE","SHAPE_RECOGNIZED","off","handleMouseDown","e","pos","target","getStage","getPointerPosition","x","y","handleMouseMove","handleMouseUp","lastElement","type","FREEHAND","recognized","emit","className","children","width","window","innerWidth","height","innerHeight","onMouseDown","onMouseMove","onMouseUp","ref","map","flat","stroke","strokeWidth","tension","lineCap","lineJoin","fileName","_jsxFileName","lineNumber","columnNumber","CIRCLE","radius","RECTANGLE","_c","$RefreshReg$"],"sources":["C:/Users/Amoolya Suneja/Desktop/AI-Liveboard/client/src/components/whiteboard.jsx"],"sourcesContent":["import React, { useRef, useEffect, useContext } from 'react';\r\nimport { Stage, Layer, Line, Circle, Rect } from 'react-konva';\r\nimport { SHAPES, EVENTS } from '../utils/constants';\r\nimport useDrawing from '../hooks/useDrawing.js';\r\nimport { SocketContext } from '../context/SocketContext';\r\nimport { recognizeShape } from '../utils/shapeRecognition';\r\n\r\nconst Whiteboard = ({ roomId, users }) => {\r\n  const socket = useContext(SocketContext);\r\n  const stageRef = useRef(null);\r\n  const {\r\n    elements,\r\n    setElements,\r\n    isDrawing,\r\n    handleDrawStart,\r\n    handleDrawMove,\r\n    handleDrawEnd\r\n  } = useDrawing(socket, roomId);\r\n\r\n  // Socket listeners\r\n  useEffect(() => {\r\n    const handleRemoteDrawStart = (element) => {\r\n      setElements(prev => [...prev, element]);\r\n    };\r\n\r\n    const handleRemoteDrawMove = (point) => {\r\n      setElements(prev => {\r\n        const lastIndex = prev.length - 1;\r\n        const updated = [...prev];\r\n        updated[lastIndex] = {\r\n          ...updated[lastIndex],\r\n          points: [...updated[lastIndex].points, point]\r\n        };\r\n        return updated;\r\n      });\r\n    };\r\n\r\n    const handleShapeRecognized = (shape) => {\r\n      setElements(prev => [\r\n        ...prev.filter(el => !el.temp),\r\n        { ...shape, id: Date.now() }\r\n      ]);\r\n    };\r\n\r\n    socket.on(EVENTS.DRAW_START, handleRemoteDrawStart);\r\n    socket.on(EVENTS.DRAW_MOVE, handleRemoteDrawMove);\r\n    socket.on(EVENTS.SHAPE_RECOGNIZED, handleShapeRecognized);\r\n\r\n    return () => {\r\n      socket.off(EVENTS.DRAW_START, handleRemoteDrawStart);\r\n      socket.off(EVENTS.DRAW_MOVE, handleRemoteDrawMove);\r\n      socket.off(EVENTS.SHAPE_RECOGNIZED, handleShapeRecognized);\r\n    };\r\n  }, [setElements, socket]);\r\n\r\n  // Drawing events\r\n  const handleMouseDown = (e) => {\r\n    const pos = e.target.getStage().getPointerPosition();\r\n    handleDrawStart(pos.x, pos.y);\r\n  };\r\n\r\n  const handleMouseMove = (e) => {\r\n    if (!isDrawing) return;\r\n    const pos = e.target.getStage().getPointerPosition();\r\n    handleDrawMove(pos.x, pos.y);\r\n  };\r\n\r\n  const handleMouseUp = () => {\r\n    if (!isDrawing) return;\r\n    handleDrawEnd();\r\n    \r\n    const lastElement = elements[elements.length - 1];\r\n    if (lastElement?.type === SHAPES.FREEHAND) {\r\n      const recognized = recognizeShape(lastElement.points);\r\n      if (recognized) {\r\n        socket.emit(EVENTS.SHAPE_RECOGNIZED, {\r\n          roomId,\r\n          shape: recognized\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"whiteboard\">\r\n      <Stage\r\n        width={window.innerWidth - 300}\r\n        height={window.innerHeight - 100}\r\n        onMouseDown={handleMouseDown}\r\n        onMouseMove={handleMouseMove}\r\n        onMouseUp={handleMouseUp}\r\n        ref={stageRef}\r\n      >\r\n        <Layer>\r\n          {elements.map((element) => {\r\n            if (element.type === SHAPES.FREEHAND) {\r\n              return (\r\n                <Line\r\n                  key={element.id}\r\n                  points={element.points.flat()}\r\n                  stroke=\"#000\"\r\n                  strokeWidth={5}\r\n                  tension={0.5}\r\n                  lineCap=\"round\"\r\n                  lineJoin=\"round\"\r\n                />\r\n              );\r\n            }\r\n            if (element.type === SHAPES.CIRCLE) {\r\n              return (\r\n                <Circle\r\n                  key={element.id}\r\n                  x={element.x + element.radius}\r\n                  y={element.y + element.radius}\r\n                  radius={element.radius}\r\n                  stroke=\"#000\"\r\n                  strokeWidth={3}\r\n                />\r\n              );\r\n            }\r\n            if (element.type === SHAPES.RECTANGLE) {\r\n              return (\r\n                <Rect\r\n                  key={element.id}\r\n                  x={element.x}\r\n                  y={element.y}\r\n                  width={element.width}\r\n                  height={element.height}\r\n                  stroke=\"#000\"\r\n                  strokeWidth={3}\r\n                />\r\n              );\r\n            }\r\n            return null;\r\n          })}\r\n        </Layer>\r\n      </Stage>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Whiteboard;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,MAAM,EAAEC,SAAS,EAAEC,UAAU,QAAQ,OAAO;AAC5D,SAASC,KAAK,EAAEC,KAAK,EAAEC,IAAI,EAAEC,MAAM,EAAEC,IAAI,QAAQ,aAAa;AAC9D,SAASC,MAAM,EAAEC,MAAM,QAAQ,oBAAoB;AACnD,OAAOC,UAAU,MAAM,wBAAwB;AAC/C,SAASC,aAAa,QAAQ,0BAA0B;AACxD,SAASC,cAAc,QAAQ,2BAA2B;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE3D,MAAMC,UAAU,GAAGA,CAAC;EAAEC,MAAM;EAAEC;AAAM,CAAC,KAAK;EAAAC,EAAA;EACxC,MAAMC,MAAM,GAAGjB,UAAU,CAACS,aAAa,CAAC;EACxC,MAAMS,QAAQ,GAAGpB,MAAM,CAAC,IAAI,CAAC;EAC7B,MAAM;IACJqB,QAAQ;IACRC,WAAW;IACXC,SAAS;IACTC,eAAe;IACfC,cAAc;IACdC;EACF,CAAC,GAAGhB,UAAU,CAACS,MAAM,EAAEH,MAAM,CAAC;;EAE9B;EACAf,SAAS,CAAC,MAAM;IACd,MAAM0B,qBAAqB,GAAIC,OAAO,IAAK;MACzCN,WAAW,CAACO,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAED,OAAO,CAAC,CAAC;IACzC,CAAC;IAED,MAAME,oBAAoB,GAAIC,KAAK,IAAK;MACtCT,WAAW,CAACO,IAAI,IAAI;QAClB,MAAMG,SAAS,GAAGH,IAAI,CAACI,MAAM,GAAG,CAAC;QACjC,MAAMC,OAAO,GAAG,CAAC,GAAGL,IAAI,CAAC;QACzBK,OAAO,CAACF,SAAS,CAAC,GAAG;UACnB,GAAGE,OAAO,CAACF,SAAS,CAAC;UACrBG,MAAM,EAAE,CAAC,GAAGD,OAAO,CAACF,SAAS,CAAC,CAACG,MAAM,EAAEJ,KAAK;QAC9C,CAAC;QACD,OAAOG,OAAO;MAChB,CAAC,CAAC;IACJ,CAAC;IAED,MAAME,qBAAqB,GAAIC,KAAK,IAAK;MACvCf,WAAW,CAACO,IAAI,IAAI,CAClB,GAAGA,IAAI,CAACS,MAAM,CAACC,EAAE,IAAI,CAACA,EAAE,CAACC,IAAI,CAAC,EAC9B;QAAE,GAAGH,KAAK;QAAEI,EAAE,EAAEC,IAAI,CAACC,GAAG,CAAC;MAAE,CAAC,CAC7B,CAAC;IACJ,CAAC;IAEDxB,MAAM,CAACyB,EAAE,CAACnC,MAAM,CAACoC,UAAU,EAAElB,qBAAqB,CAAC;IACnDR,MAAM,CAACyB,EAAE,CAACnC,MAAM,CAACqC,SAAS,EAAEhB,oBAAoB,CAAC;IACjDX,MAAM,CAACyB,EAAE,CAACnC,MAAM,CAACsC,gBAAgB,EAAEX,qBAAqB,CAAC;IAEzD,OAAO,MAAM;MACXjB,MAAM,CAAC6B,GAAG,CAACvC,MAAM,CAACoC,UAAU,EAAElB,qBAAqB,CAAC;MACpDR,MAAM,CAAC6B,GAAG,CAACvC,MAAM,CAACqC,SAAS,EAAEhB,oBAAoB,CAAC;MAClDX,MAAM,CAAC6B,GAAG,CAACvC,MAAM,CAACsC,gBAAgB,EAAEX,qBAAqB,CAAC;IAC5D,CAAC;EACH,CAAC,EAAE,CAACd,WAAW,EAAEH,MAAM,CAAC,CAAC;;EAEzB;EACA,MAAM8B,eAAe,GAAIC,CAAC,IAAK;IAC7B,MAAMC,GAAG,GAAGD,CAAC,CAACE,MAAM,CAACC,QAAQ,CAAC,CAAC,CAACC,kBAAkB,CAAC,CAAC;IACpD9B,eAAe,CAAC2B,GAAG,CAACI,CAAC,EAAEJ,GAAG,CAACK,CAAC,CAAC;EAC/B,CAAC;EAED,MAAMC,eAAe,GAAIP,CAAC,IAAK;IAC7B,IAAI,CAAC3B,SAAS,EAAE;IAChB,MAAM4B,GAAG,GAAGD,CAAC,CAACE,MAAM,CAACC,QAAQ,CAAC,CAAC,CAACC,kBAAkB,CAAC,CAAC;IACpD7B,cAAc,CAAC0B,GAAG,CAACI,CAAC,EAAEJ,GAAG,CAACK,CAAC,CAAC;EAC9B,CAAC;EAED,MAAME,aAAa,GAAGA,CAAA,KAAM;IAC1B,IAAI,CAACnC,SAAS,EAAE;IAChBG,aAAa,CAAC,CAAC;IAEf,MAAMiC,WAAW,GAAGtC,QAAQ,CAACA,QAAQ,CAACY,MAAM,GAAG,CAAC,CAAC;IACjD,IAAI,CAAA0B,WAAW,aAAXA,WAAW,uBAAXA,WAAW,CAAEC,IAAI,MAAKpD,MAAM,CAACqD,QAAQ,EAAE;MACzC,MAAMC,UAAU,GAAGlD,cAAc,CAAC+C,WAAW,CAACxB,MAAM,CAAC;MACrD,IAAI2B,UAAU,EAAE;QACd3C,MAAM,CAAC4C,IAAI,CAACtD,MAAM,CAACsC,gBAAgB,EAAE;UACnC/B,MAAM;UACNqB,KAAK,EAAEyB;QACT,CAAC,CAAC;MACJ;IACF;EACF,CAAC;EAED,oBACEhD,OAAA;IAAKkD,SAAS,EAAC,YAAY;IAAAC,QAAA,eACzBnD,OAAA,CAACX,KAAK;MACJ+D,KAAK,EAAEC,MAAM,CAACC,UAAU,GAAG,GAAI;MAC/BC,MAAM,EAAEF,MAAM,CAACG,WAAW,GAAG,GAAI;MACjCC,WAAW,EAAEtB,eAAgB;MAC7BuB,WAAW,EAAEf,eAAgB;MAC7BgB,SAAS,EAAEf,aAAc;MACzBgB,GAAG,EAAEtD,QAAS;MAAA6C,QAAA,eAEdnD,OAAA,CAACV,KAAK;QAAA6D,QAAA,EACH5C,QAAQ,CAACsD,GAAG,CAAE/C,OAAO,IAAK;UACzB,IAAIA,OAAO,CAACgC,IAAI,KAAKpD,MAAM,CAACqD,QAAQ,EAAE;YACpC,oBACE/C,OAAA,CAACT,IAAI;cAEH8B,MAAM,EAAEP,OAAO,CAACO,MAAM,CAACyC,IAAI,CAAC,CAAE;cAC9BC,MAAM,EAAC,MAAM;cACbC,WAAW,EAAE,CAAE;cACfC,OAAO,EAAE,GAAI;cACbC,OAAO,EAAC,OAAO;cACfC,QAAQ,EAAC;YAAO,GANXrD,OAAO,CAACa,EAAE;cAAAyC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAOhB,CAAC;UAEN;UACA,IAAIzD,OAAO,CAACgC,IAAI,KAAKpD,MAAM,CAAC8E,MAAM,EAAE;YAClC,oBACExE,OAAA,CAACR,MAAM;cAELiD,CAAC,EAAE3B,OAAO,CAAC2B,CAAC,GAAG3B,OAAO,CAAC2D,MAAO;cAC9B/B,CAAC,EAAE5B,OAAO,CAAC4B,CAAC,GAAG5B,OAAO,CAAC2D,MAAO;cAC9BA,MAAM,EAAE3D,OAAO,CAAC2D,MAAO;cACvBV,MAAM,EAAC,MAAM;cACbC,WAAW,EAAE;YAAE,GALVlD,OAAO,CAACa,EAAE;cAAAyC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAMhB,CAAC;UAEN;UACA,IAAIzD,OAAO,CAACgC,IAAI,KAAKpD,MAAM,CAACgF,SAAS,EAAE;YACrC,oBACE1E,OAAA,CAACP,IAAI;cAEHgD,CAAC,EAAE3B,OAAO,CAAC2B,CAAE;cACbC,CAAC,EAAE5B,OAAO,CAAC4B,CAAE;cACbU,KAAK,EAAEtC,OAAO,CAACsC,KAAM;cACrBG,MAAM,EAAEzC,OAAO,CAACyC,MAAO;cACvBQ,MAAM,EAAC,MAAM;cACbC,WAAW,EAAE;YAAE,GANVlD,OAAO,CAACa,EAAE;cAAAyC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAOhB,CAAC;UAEN;UACA,OAAO,IAAI;QACb,CAAC;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACG;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACH;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACL,CAAC;AAEV,CAAC;AAACnE,EAAA,CApIIH,UAAU;EAAA,QAUVL,UAAU;AAAA;AAAA+E,EAAA,GAVV1E,UAAU;AAsIhB,eAAeA,UAAU;AAAC,IAAA0E,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}